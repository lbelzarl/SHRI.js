!function(){function t(t,e){this.firstName=t,this.lastName=e,this.fullName=t+" "+e,this._tasks=[],this._mentors=[]}function e(t){this.teamName=t,this._members=[],this._tasks=[]}function s(t,e){this.taskName=t,this.description=e}function n(t,e){this.firstName=t,this.lastName=e,this.fullName=t+" "+e,this._students=[]}function r(t,e){function s(t){for(var e=[],s=0;s<n.length;s++)n[s].protege.indexOf(t)>=0&&e.push(n[s]);return e}for(var n=[],r=0;r<t.length;r++){for(var i=t[r],a=i.getStudents(),o=[],u=0;u<a.length;u++){var h=a[u].getMentors();h.indexOf(i)>=0&&o.push(a[u])}o.length&&n.push({mentor:i,protege:o})}for(var r=0;r<e.length;r++){var d=s(e[r]);if(d.length>1)for(var f=e[r].getMentors()[0],u=0;u<d.length;u++)d[u].mentor!==f&&d[u].protege.splice(d[u].protege.indexOf(e[r]),1)}return n}function i(){return{students:o.getAll().map(function(t){return t.serialize()}),teams:u.getAll().map(function(t){return t.serialize()}),tasks:h.getAll().map(function(t){return t.serialize()}),mentors:d.getAll().map(function(t){return t.serialize()})}}function a(t){h["delete"]();for(var e=0;e<t.tasks.length;e++)h.create(t.tasks[e][0],t.tasks[e][1]);o["delete"]();for(var e=0;e<t.students.length;e++)for(var s=t.students[e],n=(o.add(s[0],s[1]),o.getStudent(e)),r=t.students[e][2],i=0;i<r.length;i++)n.addTask(r[i].task),n.assignMark(r[i].task,r[i].mark);u["delete"]();for(var e=0;e<t.teams.length;e++){for(var a=t.teams[e],f=a[1],l=u.create(a[0]),r=t.students[e][2],i=0;i<f.length;i++)l.addMember(o.getStudent(f[i]));for(var i=0;i<r.length;i++)l.addTask(r[i].task),l.assignMark(r[i].task,r[i].mark)}d["delete"]();for(var e=0;e<t.mentors.length;e++)for(var m=t.mentors[e],g=d.add(m[0],m[1]),_=d.getMentor(g),c=m[2],i=0;i<c.length;i++)_.addStudent(o.getStudent(c[i]));for(var e=0;e<t.students.length;e++)for(var n=o.getStudent(e),p=t.students[e][3],i=0;i<p.length;i++)n.addMentor(d.getMentor(p[i]))}var o={_students:[],add:function(e,s){return this._students.push(new t(e,s)),this._students.length-1},getStudent:function(t){return this._students[t]},getAll:function(){return this._students},getStudentId:function(t){for(var e=0;e<this._students.length;e++)if(t===this._students[e])return e;return null},"delete":function(t){void 0===t?this._students=[]:this._students.splice(t,1)},assignMentors:function(t){for(var e=this._students,s=0;s<e.length;s++){var n=Math.floor(Math.random()*t.length);for(e[s].addMentor(t[n]);;){var r=Math.floor(Math.random()*t.length);if(n!==r){e[s].addMentor(t[r]);break}}}},emptyAllMentors:function(){for(var t=this._students,e=0;e<t.length;e++)t[e].deleteMentors()},shuffle:function(){this._students.sort(function(t,e){return Math.round(Math.random())-.5})}};t.prototype.serialize=function(){return[this.firstName,this.lastName,this._tasks,this._mentors.map(function(t){return d.getId(t)})]},t.prototype.addMentor=function(t){this._mentors.push(t)},t.prototype.addTask=function(t){this._tasks.push({task:t,mark:null})},t.prototype.assignMark=function(t,e){for(var s=0;s<this._tasks.length;s++)t==this._tasks[s].task&&(this._tasks[s].mark=e)},t.prototype.getMentors=function(){return this._mentors},t.prototype.deleteMentors=function(t){void 0===t?this._mentors=[]:this._mentors.splice(t,1)};var u={_teams:[],find:function(t){for(var e=0;e<this._teams.length;e++)if(t===this._teams[e].teamName)return this._teams[e];return null},getTeam:function(t){return this._teams[t]},create:function(t){if(null!==this.find(t))return null;var s=new e(t);return this._teams.push(s),s},getTeamId:function(t){for(var e=0;e<this._teams.length;e++)if(t===this._teams[e])return e;return null},getMemberTeam:function(t){for(var e=0;e<this._teams.length;e++)if(this._teams[e].hasMember(t))return this._teams[e].teamName;return null},"delete":function(t){return void 0===t?void(this._teams=[]):void this._teams.splice(t,1)},getAll:function(){return this._teams},shuffle:function(){this._teams.sort(function(t,e){return Math.round(Math.random())-.5})}};e.prototype.hasMember=function(t){for(var e=0;e<this._members.length;e++)if(this._members[e]===t)return!0;return!1},e.prototype.addMember=function(t){return u.getMemberTeam(t)?!1:(this._members.push(t),!0)},e.prototype.getAllMembers=function(){return this._members},e.prototype.serialize=function(){return[this.teamName,this._members.map(function(t){return o.getStudentId(t)}),this._tasks]},e.prototype.delMember=function(t){if(void 0===t)return this._members=[],!0;for(var e=0;e<this._members.length;e++)if(this._members[e]===t)return this._members.splice(e,1),!0;return!1},e.prototype.addTask=function(t){this._tasks.push({task:t,mark:null})},e.prototype.assignMark=function(t,e){for(var s=0;s<this._tasks.length;s++)t==this._tasks[s].task&&(this._tasks[s].mark=e)};var h={_tasks:[],create:function(t,e){return this._tasks.push(new s(t,e)),this._tasks.length-1},get:function(t){return this._tasks[t]},getId:function(t){for(var e=0;e<this._tasks.length;e++)if(t===this._tasks[e])return e;return null},getAll:function(){return this._tasks},"delete":function(t){void 0===t?this._tasks=[]:this._tasks.splice(t,1)}};s.prototype.serialize=function(){return[this.taskName,this.description]};var d={_mentors:[],getAll:function(){return this._mentors},add:function(t,e){return this._mentors.push(new n(t,e)),this._mentors.length-1},getMentor:function(t){return this._mentors[t]},getId:function(t){for(var e=0;e<this._mentors.length;e++)if(t===this._mentors[e])return e;return null},"delete":function(t){void 0===t?this._mentors=[]:this._mentors.splice(t,1)},assignStudents:function(t){if(t.length)for(var e=this._mentors,s=0;s<e.length;s++){var n=Math.floor(Math.random()*t.length);for(e[s].addStudent(t[n]);;){var r=Math.floor(Math.random()*t.length);if(n!==r){e[s].addStudent(t[r]);break}}}}};n.prototype.addStudent=function(t){this._students.push(t)},n.prototype.getStudents=function(){return this._students},n.prototype.deleteStudents=function(t){void 0===id?this._students=[]:this._students.splice(t,1)},n.prototype.serialize=function(){return[this.firstName,this.lastName,this._students.map(function(t){return o.getStudentId(t)})]};var f={Students:o,Student:t,Teams:u,Team:e,Tasks:h,Task:s,Mentors:d,Mentor:n,assign:r,serialize:i,deserialize:a};"object"==typeof module&&module.exports?module.exports=f:window.SHRI=f}();